@extends('layout.template')

@section('pageTitle')
    <title>Piccolo Pay - Verify Account</title>        
@endsection

@section('pageMeta')
    <meta name ="description", content="Unlock a world of seamless transactions and top-notch services with Piccolo Pay. We pride ourselves on being your go-to destination for airtime, data, TV subscriptions and electricity bill purchases.">
    <meta name ="keywords", content="Data, Airtime">
    <meta name="author" content="Team Piccolo">
@endsection

@section('pageContents')
    <!-- Page Contents  -->
        <div id="pageContents" class="py-12 my-2">
            <div class="lg:mx-24 lg:grid grid-cols-2 items-center gap-4">
                <div class="mx-auto">
                    <div class="px-4">
                        <svg id="loginIcon" viewBox="0 0 305 212" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <g clip-path="url(#clip0_36_1551)">
                                <path d="M60.7692 212C94.3311 212 121.538 209.936 121.538 207.389C121.538 204.843 94.3311 202.778 60.7692 202.778C27.2073 202.778 0 204.843 0 207.389C0 209.936 27.2073 212 60.7692 212Z" fill="#E6E6E6"/>
                                <path d="M46.4509 47.0389C57.0265 42.5451 70.1987 45.3923 83.0628 47.3684C83.1825 44.9754 84.6335 42.0629 83.1135 40.3933C81.2669 38.365 81.4369 36.2337 82.5481 34.0902C85.3896 28.609 81.3185 22.7766 77.208 17.9271C76.2815 16.8365 75.1106 15.9796 73.7904 15.426C72.4702 14.8724 71.0379 14.6377 69.6098 14.741L61.9954 15.2844C60.1425 15.4166 58.3742 16.111 56.9271 17.2747C55.4801 18.4383 54.4232 20.0157 53.8981 21.7959C52.0799 24.2662 51.1068 26.7298 51.7195 29.1805C48.9961 31.0398 48.5386 33.2841 49.7623 35.8142C50.8 37.4073 50.789 38.958 49.7151 40.4658C48.3048 42.3881 47.2247 44.5315 46.5189 46.8081L46.4509 47.0389Z" fill="#2F2E41"/>
                                <path d="M297.773 183.271H82.2273C80.3105 183.271 78.4722 182.51 77.1168 181.156C75.7614 179.802 75 177.965 75 176.05C153.135 166.978 229.802 166.978 305 176.05C305 177.965 304.239 179.802 302.883 181.156C301.528 182.51 299.689 183.271 297.773 183.271Z" fill="#2F2E41"/>
                                <path d="M305 176.475L75 176.05L101.656 131.241L101.784 131.029V32.2754C101.784 31.0767 102.02 29.8898 102.479 28.7823C102.938 27.6749 103.611 26.6687 104.459 25.8211C105.308 24.9735 106.315 24.3012 107.424 23.8425C108.532 23.3839 109.72 23.1478 110.92 23.1479H267.805C269.004 23.1478 270.192 23.3839 271.301 23.8425C272.409 24.3012 273.417 24.9735 274.265 25.8211C275.113 26.6687 275.786 27.6749 276.246 28.7823C276.705 29.8898 276.941 31.0767 276.941 32.2754V131.709L305 176.475Z" fill="#8B87C0"/>
                                <path d="M110.712 29.5186C109.923 29.5194 109.166 29.833 108.608 30.3903C108.05 30.9477 107.737 31.7034 107.736 32.4917V122.534C107.737 123.322 108.05 124.078 108.608 124.636C109.166 125.193 109.923 125.506 110.712 125.507H269.288C270.077 125.506 270.834 125.193 271.392 124.635C271.95 124.078 272.263 123.322 272.264 122.534V32.4917C272.263 31.7034 271.95 30.9477 271.392 30.3904C270.834 29.833 270.077 29.5195 269.288 29.5186H110.712Z" fill="white"/>
                                <path d="M111.376 137.4C111.132 137.4 110.894 137.47 110.688 137.602C110.483 137.733 110.32 137.92 110.217 138.142L102.004 155.98C101.914 156.174 101.875 156.388 101.89 156.601C101.905 156.814 101.973 157.02 102.088 157.2C102.204 157.38 102.363 157.528 102.55 157.631C102.738 157.733 102.948 157.787 103.162 157.787H275.89C276.107 157.787 276.321 157.731 276.511 157.626C276.701 157.52 276.861 157.367 276.975 157.183C277.089 156.998 277.154 156.787 277.164 156.57C277.174 156.353 277.128 156.137 277.031 155.943L268.103 138.104C267.997 137.892 267.835 137.714 267.633 137.589C267.432 137.465 267.199 137.399 266.962 137.4H111.376Z" fill="#2F2E41"/>
                                <path d="M189.362 28.032C190.419 28.032 191.275 27.1763 191.275 26.1208C191.275 25.0652 190.419 24.2095 189.362 24.2095C188.306 24.2095 187.449 25.0652 187.449 26.1208C187.449 27.1763 188.306 28.032 189.362 28.032Z" fill="white"/>
                                <path d="M172.385 161.185C172.104 161.185 171.832 161.277 171.609 161.448C171.387 161.618 171.226 161.857 171.153 162.127L169.093 169.772C169.042 169.961 169.035 170.159 169.073 170.351C169.111 170.543 169.193 170.724 169.312 170.879C169.431 171.034 169.584 171.16 169.76 171.246C169.935 171.333 170.129 171.378 170.324 171.378H209.507C209.71 171.378 209.91 171.33 210.091 171.236C210.272 171.143 210.428 171.008 210.545 170.843C210.663 170.677 210.74 170.486 210.769 170.285C210.798 170.084 210.778 169.879 210.711 169.687L208.063 162.042C207.976 161.792 207.813 161.575 207.597 161.421C207.381 161.267 207.123 161.185 206.857 161.185H172.385Z" fill="#2F2E41"/>
                                <path d="M276.941 129.542V131.241H101.656L101.788 131.029V129.542H276.941Z" fill="#2F2E41"/>
                                <path d="M272.052 59.4621C288.488 59.4621 301.812 46.151 301.812 29.731C301.812 13.311 288.488 0 272.052 0C255.616 0 242.292 13.311 242.292 29.731C242.292 46.151 255.616 59.4621 272.052 59.4621Z" fill="#05976A"/>
                                <path d="M284.381 42.6852H259.723C259.272 42.6848 258.84 42.5056 258.521 42.1871C258.202 41.8686 258.023 41.4368 258.022 40.9863V26.1208C258.023 25.6704 258.202 25.2385 258.521 24.92C258.84 24.6015 259.272 24.4224 259.723 24.4219H284.381C284.832 24.4224 285.264 24.6015 285.583 24.92C285.902 25.2385 286.081 25.6704 286.081 26.1208V40.9863C286.081 41.4367 285.902 41.8686 285.583 42.1871C285.264 42.5057 284.832 42.6848 284.381 42.6852ZM259.723 26.1208V40.9863H284.382L284.381 26.1208L259.723 26.1208Z" fill="white"/>
                                <path d="M279.704 26.1208H264.399V19.3252C264.399 14.403 267.618 10.8306 272.052 10.8306C276.486 10.8306 279.704 14.403 279.704 19.3252L279.704 26.1208ZM266.1 24.4219H278.004V19.3252C278.004 15.324 275.556 12.5295 272.052 12.5295C268.547 12.5295 266.1 15.324 266.1 19.3252L266.1 24.4219Z" fill="white"/>
                                <path d="M272.052 34.828C272.991 34.828 273.752 34.0674 273.752 33.1291C273.752 32.1908 272.991 31.4302 272.052 31.4302C271.113 31.4302 270.351 32.1908 270.351 33.1291C270.351 34.0674 271.113 34.828 272.052 34.828Z" fill="white"/>
                                <path d="M251.277 94.9658H128.723C128.121 94.9651 127.545 94.726 127.119 94.3009C126.694 93.8759 126.454 93.2996 126.454 92.6985V62.3274C126.454 61.7263 126.694 61.15 127.119 60.7249C127.545 60.2999 128.121 60.0608 128.723 60.0601H251.277C251.879 60.0608 252.455 60.2999 252.881 60.7249C253.306 61.15 253.546 61.7263 253.546 62.3274V92.6985C253.546 93.2996 253.306 93.8759 252.881 94.3009C252.455 94.726 251.879 94.9651 251.277 94.9658ZM128.723 60.967C128.362 60.9674 128.016 61.1109 127.761 61.3659C127.505 61.6209 127.362 61.9667 127.361 62.3274V92.6985C127.362 93.0592 127.505 93.405 127.761 93.66C128.016 93.915 128.362 94.0585 128.723 94.0589H251.277C251.638 94.0585 251.984 93.915 252.239 93.66C252.495 93.405 252.638 93.0592 252.639 92.6985V62.3274C252.638 61.9667 252.495 61.6209 252.239 61.3659C251.984 61.1108 251.638 60.9674 251.277 60.967L128.723 60.967Z" fill="#E6E6E6"/>
                                <path d="M147.765 85.5836C152.871 85.5836 157.01 81.4485 157.01 76.3477C157.01 71.2469 152.871 67.1118 147.765 67.1118C142.66 67.1118 138.521 71.2469 138.521 76.3477C138.521 81.4485 142.66 85.5836 147.765 85.5836Z" fill="#E6E6E6"/>
                                <path d="M169.117 70.1904C168.914 70.1901 168.713 70.2297 168.526 70.3069C168.339 70.3841 168.169 70.4975 168.026 70.6404C167.882 70.7834 167.768 70.9532 167.691 71.1401C167.613 71.327 167.573 71.5274 167.573 71.7297C167.573 71.9321 167.613 72.1325 167.691 72.3194C167.768 72.5063 167.882 72.6761 168.026 72.8191C168.169 72.962 168.339 73.0754 168.526 73.1526C168.713 73.2298 168.914 73.2694 169.117 73.2691H241.754C242.163 73.2691 242.555 73.1069 242.844 72.8182C243.133 72.5295 243.295 72.138 243.295 71.7297C243.295 71.3215 243.133 70.93 242.844 70.6413C242.555 70.3526 242.163 70.1904 241.754 70.1904H169.117Z" fill="#E6E6E6"/>
                                <path d="M169.117 79.4263C168.708 79.4263 168.316 79.5884 168.027 79.8771C167.738 80.1658 167.576 80.5573 167.576 80.9656C167.576 81.3738 167.738 81.7654 168.027 82.054C168.316 82.3427 168.708 82.5049 169.117 82.5049H200.373C200.781 82.5049 201.173 82.3427 201.462 82.054C201.751 81.7654 201.914 81.3738 201.914 80.9656C201.914 80.5573 201.751 80.1658 201.462 79.8771C201.173 79.5884 200.781 79.4263 200.373 79.4263H169.117Z" fill="#E6E6E6"/>
                                <path d="M101.355 80.0492L78.6996 92.0821L78.4128 82.0547C85.8073 80.8215 92.8423 78.6743 99.3472 75.1788L101.717 69.3305C101.975 68.6933 102.394 68.1341 102.934 67.7078C103.474 67.2814 104.116 67.0027 104.796 66.8989C105.476 66.7952 106.172 66.8699 106.814 67.1158C107.457 67.3617 108.025 67.7703 108.461 68.3016C109.101 69.0788 109.42 70.0697 109.355 71.0734C109.29 72.0772 108.846 73.0188 108.112 73.7075L101.355 80.0492Z" fill="#FFB8B8"/>
                                <path d="M45.9993 149.522C45.834 148.917 45.7989 148.283 45.8963 147.663C45.9937 147.043 46.2214 146.451 46.5644 145.925L51.5411 138.294C52.7182 136.49 54.5243 135.186 56.6091 134.637C58.6939 134.087 60.9087 134.331 62.8238 135.321C60.7322 138.877 61.0238 141.998 63.5461 144.709C59.6305 146.619 56.0116 149.084 52.8015 152.027C52.2154 152.426 51.5424 152.68 50.8385 152.766C50.1345 152.853 49.4201 152.77 48.7546 152.525C48.0891 152.28 47.4918 151.88 47.0125 151.358C46.5333 150.835 46.1859 150.206 45.9993 149.522Z" fill="#2F2E41"/>
                                <path d="M102.386 139.546C101.633 140.799 100.57 141.839 99.2993 142.564C98.0284 143.29 96.5921 143.676 95.1284 143.687L62.0668 143.938L60.6329 135.629L75.2583 131.332L62.9271 121.877L76.4054 106.12L100.886 128.915C102.317 130.247 103.247 132.03 103.52 133.965C103.793 135.9 103.393 137.87 102.386 139.546Z" fill="#2F2E41"/>
                                <path d="M56.9049 196.367H49.162C42.2101 148.76 35.1337 101.019 56.0446 83.2007L80.707 87.2116L77.5525 108.126L63.7874 123.883L56.9049 196.367Z" fill="#2F2E41"/>
                                <path d="M63.7112 207.151C63.1051 207.316 62.4708 207.351 61.8501 207.254C61.2294 207.157 60.6364 206.929 60.11 206.587L51.7028 205.458C49.8963 204.282 48.5914 202.477 48.0412 200.395C47.4911 198.312 47.735 196.099 48.7255 194.186C52.2859 196.275 55.409 195.984 58.1231 193.464C60.0407 197.332 63.2003 197.096 66.2179 200.355C66.6174 200.941 66.8712 201.613 66.958 202.316C67.0448 203.02 66.9621 203.733 66.7168 204.398C66.4716 205.063 66.0709 205.66 65.5481 206.139C65.0253 206.617 64.3955 206.965 63.7112 207.151Z" fill="#2F2E41"/>
                                <path d="M75.2583 51.3996L60.9197 47.9616C63.3011 43.0918 63.4972 37.673 62.3535 31.9178L72.1038 31.6313C72.4093 38.7881 73.3336 45.4742 75.2583 51.3996Z" fill="#FFB8B8"/>
                                <path d="M79.1991 95.8375C68.7611 102.943 61.3859 96.0806 55.7578 85.4923C56.5399 79.0132 55.2736 71.2596 52.9283 62.8347C51.8853 59.1188 52.2747 55.1472 54.0196 51.7041C55.7646 48.2609 58.7382 45.5965 62.3536 44.2368L74.6848 49.3938C85.1554 57.9203 87.2163 67.1563 83.2879 76.8974L79.1991 95.8375Z" fill="#05976A"/>
                                <path d="M49.162 58.5618L37.6911 64.5782L58.052 76.611L60.8851 83.5926C61.0742 84.0586 61.1663 84.5581 61.1558 85.0608C61.1453 85.5635 61.0325 86.0588 60.8241 86.5166C60.6158 86.9743 60.3163 87.3848 59.944 87.7231C59.5716 88.0614 59.1342 88.3204 58.6584 88.4843C58.1176 88.6707 57.5409 88.7294 56.9735 88.6559C56.4061 88.5824 55.8635 88.3786 55.3881 88.0606C54.9127 87.7426 54.5174 87.319 54.2332 86.8229C53.9491 86.3269 53.7837 85.7718 53.7501 85.2012L53.4636 80.3355L27.5852 71.8038C26.7133 71.5164 25.9183 71.0345 25.2605 70.3946C24.6026 69.7548 24.0991 68.9737 23.7881 68.1107C23.3347 66.8527 23.3117 65.48 23.7224 64.2075C24.1332 62.935 24.9547 61.8344 26.0583 61.078L46.8679 46.8154L49.162 58.5618Z" fill="#FFB8B8"/>
                                <path d="M60.6329 59.708C55.8488 57.6134 51.4986 59.8887 46.0075 61.7134L45.1472 46.5291C50.5996 43.6259 55.798 42.8432 60.6329 45.0967L60.6329 59.708Z" fill="#05976A"/>
                                <path d="M66.3558 39.1525C71.4117 39.1525 75.5104 35.0578 75.5104 30.0067C75.5104 24.9556 71.4117 20.8608 66.3558 20.8608C61.2998 20.8608 57.2011 24.9556 57.2011 30.0067C57.2011 35.0578 61.2998 39.1525 66.3558 39.1525Z" fill="#FFB8B8"/>
                                <path d="M77.3077 28.8526C68.2438 29.7395 61.3372 28.2585 56.9231 24.0418V20.646H76.5385L77.3077 28.8526Z" fill="#2F2E41"/>
                            </g>
                            <defs>
                                <clipPath id="clip0_36_1551">
                                    <rect width="305" height="212" fill="white"/>
                                </clipPath>
                            </defs>
                        </svg>
                    </div>
                    <div class="slogan my-4 text-black hidden lg:block">
                        Welcome Back, Login and <br> continue Transactions
                    </div>
                </div>
                <div class="lg:bg-white py-4 rounded-2xl lg:px-8 px-4">
                    <div class="slogan my-4 hidden lg:block">
                        PiccoloPay
                    </div>
                    <div class="slogan my-2 text-black text-lg">
                        Verify your account
                    </div>
                    <div class="text-xs">
                        Enter the verification code sent to your email
                    </div>
                    <div>
                        <form action="{{ route('confirm-account-confirm') }}" id="verifyCodeForm" method="POST">
                            @csrf
                            <!-- Loading -->
                            <div class="loader hidden">
                                @include('includes.loader')
                            </div>
                                                        
                            <!-- Feedback Container  -->
                            <div id="feedbackContainer" class="my-2">@include('includes.messages')</div>

                            <div class="my-4">
                                <input name="email" value="{{ $email }}" hidden>
                                <input name="username" value="{{ $username }}" hidden>
                                <input class="input_box" type="text" placeholder="Verification Code" name="verification_code" required>
                            </div>
                            <div class="my-4 flex justify-center">
                                <input style="background-color: #05976A;" class="px-6 py-3 text-white rounded-md text-sm w-full" type="submit" value="Verify" name="submit">
                            </div>
                        </form>
                    </div>
                    <div class="text-center text-sm">
                        Don't have an account? <a href="{{ route('signup') }}" class="green-text hover:green-text">Sign Up</a>
                    </div>
                </div>
            </div>
        </div>
        <script>
            // Verify Code
                $(document).on('submit', '#verifyCodeForm', function() {
                    var e = this

                    // display Loader 
                    $('.loader').show()

                    $.ajax({
                        url: $(this).attr('action'),
                        data: $(this).serialize(),
                        type: "POST",
                        dataType: 'json',
                        success: function(data) {
                            
                            if(data.status) {
                                // Loader Hide 
                                $('.loader').hide()
                                
                                $('#feedbackContainer').fadeIn().delay(5000).fadeOut()
                                
                                $("#feedbackContainer").append('<div class="alert alert-success text-xs text-center">Welcome to PiccoloPay!</div>')
                                // Redirect 
                                setTimeout(function(){
                                    window.location = data.redirect
                                }, 2000)
                            }else{
                                $(".alert").remove();
                                
                                // Loader Hide 
                                $('.loader').hide()

                                if(data.status === false) {
                                    // Check if the errors property is a string
                                    if(typeof data.errors === 'string') {
                                        $("#feedbackContainer").append('<div class="alert alert-danger text-xs">' + data.errors + '</div>');
                                    }else if(typeof data.errors === 'object') {
                                        // If errors is an object (possibly from server validation)
                                        $.each(data.errors, function (key, val) {
                                            $("#feedbackContainer").append('<div class="alert alert-danger text-xs">' + val + '</div>');
                                        });
                                    }else{
                                        // Handle other cases or provide a default message
                                        $("#feedbackContainer").append('<div class="alert alert-danger text-xs">An error occurred.</div>');
                                    }
                                }

                                // Redirect 
                                setTimeout(function(){
                                    location.reload()
                                }, 7000)

                            }
                        
                        }
                    });

                    return false;
                });
            // End of Verify Code
        </script>
    <!-- End of Page Contents  -->
@endsection